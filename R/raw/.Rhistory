spc
library(pad)
library(padr)
install.packages("padr")
library(padr)
install.packages("padr")
library(padr)
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
plotdata %>% pad
install.packages("clock")
library(clock)
plotdata %>% pad() %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"Date") %>%
mutate(Date = Date+1) %>% relocate(Date) %>% pad()
plotdata %>% pad() %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(Date) %>% first()
plotdata %>% pad() %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% first()
plotdata %>% pad() %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% summarize(RVI_1 = first(RVI))
plotdata %>% pad() %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% summarize(RVI = first(RVI))
plotdata %>% pad() %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% summarize(RVI = first(RVI)) %>% tail
plotdata %>% tail
plotdata %>% pad() %>% thicken(paste0(12, " days")) %>% head
plotdata %>% pad() %>% thicken(paste0(12, " days")) %>% tail
plotdata %>% pad(interval="day")
plotdata %>% pad(interval=paste0(12, " days"))
plotdata %>% pad(interval=c(12, "days"))
plotdata %>% pad(interval=c(12, "day"))
plotdata <- indexdata[[bandname]] %>% gather("Hectare_ID", value, -date) %>%
filter(!grepl('sd', Hectare_ID)) %>% group_by(Hectare_ID) %>% na.omit() %>%
mutate(mean = mean(value), median = median(value)) %>%
mutate(Hectare_ID, meanlab = paste('Mean =', mean), medianlab = paste('Median =', median)) %>%
mutate(meanlab = substring(meanlab, 1, 13), medianlab = substring(medianlab, 1, 15))
plotdata <- plotdata %>% group_by(date) %>% summarize("index"=mean(value, na.rm=T))
names(plotdata)[2] <- bandname
plotdata %>% pad(interval = "day")
plotdata <- plotdata %>% pad(interval = "day")
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
plotdata %>% head
plotdata %>% tail()
date1 <- seq(as.Date("2016-01-10", "2021-12-12")) %>% data.frame()
date1 <- seq(as.Date("2016-01-10", "2021-12-12", by=1)) %>% data.frame()
date1 <- seq(as.Date("2016-01-10", "2021-12-12", "days")) %>% data.frame()
date1 <- seq(as.Date("2016-01-10", "2021-12-12", by="days")) %>% data.frame()
date1 <- seq(as.Date("2016-01-10", "2021-12-12", by="day")) %>% data.frame()
date1 <- seq(as.Date("2016-01-10"), as.Date("2021-12-12"), "days") %>% data.frame()
date1
date1 <- seq(as.Date("2016-01-10"), as.Date("2021-12-31"), "days") %>% data.frame()
date1 %>% str
date1 %>% head()
date1 <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
all_dates <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
left_join(date1,plotdata,by="date")
plotdata
left_join(all_dates,plotdata,by="date")
left_join(all_dates,plotdata,by="date") %>% tail
plotdata <- indexdata[[bandname]] %>% gather("Hectare_ID", value, -date) %>%
filter(!grepl('sd', Hectare_ID)) %>% group_by(Hectare_ID) %>% na.omit() %>%
mutate(mean = mean(value), median = median(value)) %>%
mutate(Hectare_ID, meanlab = paste('Mean =', mean), medianlab = paste('Median =', median)) %>%
mutate(meanlab = substring(meanlab, 1, 13), medianlab = substring(medianlab, 1, 15))
plotdata <- plotdata %>% group_by(date) %>% summarize("index"=mean(value, na.rm=T))
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
plotdata %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% summarize(RVI = first(RVI)) %>% tail
all_dates <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
left_join(all_dates,plotdata,by="date")
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
plotdata <- indexdata[[bandname]] %>% gather("Hectare_ID", value, -date) %>%
filter(!grepl('sd', Hectare_ID)) %>% group_by(Hectare_ID) %>% na.omit() %>%
mutate(mean = mean(value), median = median(value)) %>%
mutate(Hectare_ID, meanlab = paste('Mean =', mean), medianlab = paste('Median =', median)) %>%
mutate(meanlab = substring(meanlab, 1, 13), medianlab = substring(medianlab, 1, 15))
plotdata <- plotdata %>% group_by(date) %>% summarize("index"=mean(value, na.rm=T))
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
#plotdata %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
#  mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% summarize(RVI = first(RVI)) %>% tail
all_dates <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
left_join(all_dates,plotdata,by="date")
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
plotdata <- indexdata[[bandname]] %>% gather("Hectare_ID", value, -date) %>%
filter(!grepl('sd', Hectare_ID)) %>% group_by(Hectare_ID) %>% na.omit() %>%
mutate(mean = mean(value), median = median(value)) %>%
mutate(Hectare_ID, meanlab = paste('Mean =', mean), medianlab = paste('Median =', median)) %>%
mutate(meanlab = substring(meanlab, 1, 13), medianlab = substring(medianlab, 1, 15))
plotdata <- plotdata %>% group_by(date) %>% summarize("index"=mean(value, na.rm=T))
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
#plotdata %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
#  mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% summarize(RVI = first(RVI)) %>% tail
all_dates <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
plotdata %>% head
spc <- 365 # floor(dpy/freq)            # Number of samples in one cycle (yr)
t <- as.vector(plotdata$day)  # Days since January 1, 2016
r <- t2rad(t,dpy)          # Transform days of year to radians
v <- as.vector(plotdata$RVI)   # RVI values
vx <- mean(vec.x(r,v), na.rm=TRUE) # Avg horizontal vector
vy <- mean(vec.y(r,v), na.rm=TRUE) # Avg vertical vector
rv_ang <- vec_ang(vx,vy)   # Angle of resultant vec (point of max activity)
av_ang <- avec_ang(rv_ang)  # Angle marking point of least activity
av_idx <- rad2idx(av_ang, spc=spc) # Index (1-spc) marking avg start of yr
ann_cum <- sum_cycle(v,av_idx,spc=spc)$cumsum # Accum. vals within each yr
plotdata %>% tail
av_idx
plot(v)
av_idx/v
rv_ang
av_ang
rad2idx(av_ang, spc=spy)
rad2idx(av_ang, spc=spc)
sum_cycle(v,av_idx,spc=spc)
length(v) %% spc
spc
length(v)
plotdata %>% thicken(interval = paste0(12, " days"))
plotdata[!is.na(RVI),date][1]
plotdata[!is.na(RVI),date]
plotdata %>% filter(any(values==0))
plotdata %>% filter(any(RVI!=NA))
plotdata %>% filter(any(RVI==NA))
plotdata %>% filter(any(!is.na(RVI)))
plotdata %>% filter(any(is.na(RVI)))
is.na(plotdata$RVI)
any(is.na(plotdata$RVI))
plotdata %>% which(!is.na(plot$RVI), arr.ind = T)
plotdata %>% which(!is.na(RVI), arr.ind = T)
plotdata %>% which(!is.na(plotdata%RVI), arr.ind = T)
plotdata %>% which(!is.na(plotdata$RVI), arr.ind = T)
!is.na(plotdata$RVI)
!is.na(plotdata$RVI) %>% clas
!is.na(plotdata$RVI) %>% class
plotdata %>% na.omit()
plotdata %>% na.omit() %>% first()
firstdate <- plotdata %>% na.omit() %>% first()
firstdate <- firstdate$date
firstdate
plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate)
plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate) %>% tail
dpy <- 365                 # Days/yr
plotdata <- plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate)
plotdata <- indexdata[[bandname]] %>% gather("Hectare_ID", value, -date) %>%
filter(!grepl('sd', Hectare_ID)) %>% group_by(Hectare_ID) %>% na.omit() %>%
mutate(mean = mean(value), median = median(value)) %>%
mutate(Hectare_ID, meanlab = paste('Mean =', mean), medianlab = paste('Median =', median)) %>%
mutate(meanlab = substring(meanlab, 1, 13), medianlab = substring(medianlab, 1, 15))
plotdata <- plotdata %>% group_by(date) %>% summarize("index"=mean(value, na.rm=T))
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
all_dates <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
firstdate <- plotdata %>% na.omit() %>% first()
firstdate <- firstdate$date
plotdata <- plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate) %>%
select(-date) %>% rename_at(ncol(.), ~"date") %>% relocate(date) %>% group_by(date) %>%
summarize(RVI = first(RVI))
plotdata %>% head
plotdata %>% head %>% View()
plotdata %>% View()
plotdata <- indexdata[[bandname]] %>% gather("Hectare_ID", value, -date) %>%
filter(!grepl('sd', Hectare_ID)) %>% group_by(Hectare_ID) %>% na.omit() %>%
mutate(mean = mean(value), median = median(value)) %>%
mutate(Hectare_ID, meanlab = paste('Mean =', mean), medianlab = paste('Median =', median)) %>%
mutate(meanlab = substring(meanlab, 1, 13), medianlab = substring(medianlab, 1, 15))
plotdata <- indexdata[[bandname]] %>% gather("Hectare_ID", value, -date) %>%
filter(!grepl('sd', Hectare_ID)) %>% group_by(Hectare_ID) %>% na.omit() %>%
mutate(mean = mean(value))
plotdata$value %>% sd
for (band in band.list) {
means <- indexdata[[band]] %>% gather("Hectare_ID", value, -date) %>% group_by(date) %>%
filter(!grepl('sd', Hectare_ID)) %>%
summarize(mean(value, na.rm=TRUE), sd(value, na.rm=TRUE)) %>% mutate(date = ymd(date))
names(means)[2] <- paste0(band,"_hectare_means")
indexmeans[[band]] <- means
}
indexmeans[[bandname]]
plotdata <- indexmeans[[bandname]]
plotdata
for (band in band.list) {
means <- indexdata[[band]] %>% gather("Hectare_ID", value, -date) %>% group_by(date) %>%
filter(!grepl('sd', Hectare_ID)) %>%
summarize(mean(value, na.rm=TRUE)) %>% mutate(date = ymd(date))
names(means)[2] <- paste0(band,"_hectare_means")
indexmeans[[band]] <- means
}
#choose band
bandname <- "RVI"
plotdata <- indexmeans[[bandname]]
plotdata
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
all_dates <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
firstdate <- plotdata %>% na.omit() %>% first()
firstdate <- firstdate$date
plotdata <- plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate) %>%
select(-date) %>% rename_at(ncol(.), ~"date") %>% relocate(date) %>% group_by(date) %>%
summarize(RVI = first(RVI))
plotdata
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
plotdata
plotdata %>% tail
indexdata <- vector(mode = "list", length = 0)
for (band in band.list) {
table <- read.csv(paste0(wd, "/s1/1ha/second_run/", studyarea_base, "_s1_1ha_", band, "_processed.csv"))
table <- table[,!names(table) %in% c("X")] %>% mutate(date = ymd(date))
indexdata[[band]] <- table
}
indexmeans <- vector(mode = "list", length = 0)
for (band in band.list) {
means <- indexdata[[band]] %>% gather("Hectare_ID", value, -date) %>% group_by(date) %>%
filter(!grepl('sd', Hectare_ID)) %>%
summarize(mean(value, na.rm=TRUE)) %>% mutate(date = ymd(date))
names(means)[2] <- paste0(band,"_hectare_means")
indexmeans[[band]] <- means
}
#choose band
bandname <- "RVI"
plotdata <- indexmeans[[bandname]]
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
plotdata %>% tail
all_dates <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
left_join(all_dates,plotdata,by="date")
left_join(all_dates,plotdata,by="date") %>% tail()
plotdata <- left_join(all_dates,plotdata,by="date")
firstdate <- plotdata %>% na.omit() %>% first()
firstdate <- firstdate$date
plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate)
plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate) %>% tail
plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate) %>% View
plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate) %>%
select(-date) %>% rename_at(ncol(.), ~"date") %>% relocate(date) %>% group_by(date) %>%
summarize(RVI = first(RVI)) %>% View
plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate) %>%
select(-date) %>% rename_at(ncol(.), ~"date") %>% relocate(date) %>% group_by(date) %>% View
indexdata <- vector(mode = "list", length = 0)
for (band in band.list) {
table <- read.csv(paste0(wd, "/s1/1ha/second_run/", studyarea_base, "_s1_1ha_", band, "_processed.csv"))
table <- table[,!names(table) %in% c("X")] %>% mutate(date = ymd(date))
indexdata[[band]] <- table
}
indexmeans <- vector(mode = "list", length = 0)
for (band in band.list) {
means <- indexdata[[band]] %>% gather("Hectare_ID", value, -date) %>% group_by(date) %>%
filter(!grepl('sd', Hectare_ID)) %>%
summarize(mean(value, na.rm=TRUE)) %>% mutate(date = ymd(date))
names(means)[2] <- paste0(band,"_hectare_means")
indexmeans[[band]] <- means
}
indexmeans[[bandname]]$date %>% length()
indexmeans[[bandname]]$date %>% unique %>% length()
n
n
indexdata <- vector(mode = "list", length = 0)
for (band in band.list) {
table <- read.csv(paste0(wd, "/s1/1ha/second_run/", studyarea_base, "_s1_1ha_", band, "_processed.csv"))
table <- table[,!names(table) %in% c("X")] %>% mutate(date = ymd(date))
indexdata[[band]] <- table
}
indexmeans <- vector(mode = "list", length = 0)
for (band in band.list) {
means <- indexdata[[band]] %>% gather("Hectare_ID", value, -date) %>% group_by(date) %>%
filter(!grepl('sd', Hectare_ID)) %>%
summarize(mean(value, na.rm=TRUE)) %>% mutate(date = ymd(date))
names(means)[2] <- paste0(band,"_hectare_means")
indexmeans[[band]] <- means
}
#choose band
bandname <- "RVI"
plotdata <- indexmeans[[bandname]]
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
#plotdata %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
#  mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% summarize(RVI = first(RVI))
all_dates <- seq(as.Date("2016-01-01"), as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata %>% VIew
plotdata %>% View
firstdate <- plotdata %>% na.omit() %>% first()
firstdate <- firstdate$date
plotdata %>% thicken(interval = paste0(12, " days"), start_val = firstdate) %>%
select(-date) %>% rename_at(ncol(.), ~"date") %>% relocate(date) %>% group_by(date) %>% View
names(plotdata)[2] <- bandname
plotdata %>% View
indexmeans[[bandname]] %>% tail
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
dpy <- 365                 # Days/yr
c <- 5                     # Num. of years/cycles
freq <- 12                 # Revisit time (days)
spc <- 365 # floor(dpy/freq)            # Number of samples in one cycle (yr)
t <- as.vector(plotdata$day)  # Days since January 1, 2016
r <- t2rad(t,dpy)          # Transform days of year to radians
v <- as.vector(plotdata$RVI)   # RVI values
vx <- mean(vec.x(r,v), na.rm=TRUE) # Avg horizontal vector
vy <- mean(vec.y(r,v), na.rm=TRUE) # Avg vertical vector
rv_ang <- vec_ang(vx,vy)   # Angle of resultant vec (point of max activity)
av_ang <- avec_ang(rv_ang)  # Angle marking point of least activity
av_idx <- rad2idx(av_ang, spc=spc) # Index (1-spc) marking avg start of yr
ann_cum <- sum_cycle(v,av_idx,spc=spc)$cumsum # Accum. vals within each yr
v
v %>% length
av_idx
av_idx %% v
length(v) %% av_idx
av_idx %% length(v)
av_idx
length(v)/365
#plot
dev.new(width=12,height=6)
par(mfrow=c(1,2))
cxs <- 1
plot(2000+(t/dpy), v, pch=20, col="black", xlab="years", ylab="NDVI")
plot(2000+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
#plot
dev.new(width=12,height=6)
par(mfrow=c(1,2))
cxs <- 1
plot(2000+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
#plot
dev.new(width=12,height=6)
par(mfrow=c(1,2))
cxs <- 1
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
#plot
dev.new(width=6,height=6)
par(mfrow=c(1,1))
cxs <- 1
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
lines(v)
lines(2016+(t/dpy), v)
#plot
dev.new(width=12,height=6)
par(mfrow=c(1,1))
cxs <- 1
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
#plot
dev.new(width=12,height=6)
cxs <- 1
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
#plot
dev.new(width=12,height=6)
par(mfrow=c(2,1))
cxs <- 1
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
lines(2016+(t/dpy), v)
lines(2016+(t/dpy), v, pch = 18, col = "blue", type = "b", lty = 2)
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
#plot
dev.new(width=12,height=6)
par(mfrow=c(2,1))
cxs <- 1
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
lines(2016+(t/dpy), v, pch = 18, col = "blue", type = "b", lty = 2)
#plot
dev.new(width=12,height=6)
par(mfrow=c(2,1))
cxs <- 1
plot(2016+(t/dpy), v, type = "b", pch=20, col="black", xlab="years", ylab="RVI")
#plot
dev.new(width=12,height=6)
par(mfrow=c(2,1))
cxs <- 1
plot(2016+(t/dpy), v, type = "l", pch=20, col="black", xlab="years", ylab="RVI")
#plot
dev.new(width=12,height=6)
par(mfrow=c(2,1))
cxs <- 1
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
lines(2016+(t/dpy), v, col="blue")
#plot
dev.new(width=12,height=6)
par(mfrow=c(2,1))
cxs <- 1
plot(2016+(t/dpy), v, pch=20, col="black", xlab="years", ylab="RVI")
indexdata <- vector(mode = "list", length = 0)
for (band in band.list) {
table <- read.csv(paste0(wd, "/s1/1ha/second_run/", studyarea_base, "_s1_1ha_", band, "_processed.csv"))
table <- table[,!names(table) %in% c("X")] %>% mutate(date = ymd(date))
indexdata[[band]] <- table
}
indexmeans <- vector(mode = "list", length = 0)
for (band in band.list) {
means <- indexdata[[band]] %>% gather("Hectare_ID", value, -date) %>% group_by(date) %>%
filter(!grepl('sd', Hectare_ID)) %>%
summarize(mean(value, na.rm=TRUE)) %>% mutate(date = ymd(date))
names(means)[2] <- paste0(band,"_hectare_means")
indexmeans[[band]] <- means
}
#choose band
bandname <- "RVI"
plotdata <- indexmeans[[bandname]]
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
#plotdata %>% thicken(paste0(12, " days")) %>% select(-date) %>% rename_at(ncol(.), ~"date") %>%
#  mutate(date = date+1) %>% relocate(date) %>% pad() %>% group_by(date) %>% summarize(RVI = first(RVI))
firstdate <- plotdata %>% na.omit() %>% first()
firstdate <- firstdate$date
all_dates <- seq(firstdate, as.Date("2021-12-31"), "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata %>% View
plotdata %>% slice(seq(1, nrow(.), 12))
plotdata %>% View
indexmeans[[bandname]] %>% View
indexmeans[[bandname]] %>% diff()
indexmeans[[bandname]]$date %>% diff()
plotdata %>% slice(seq(1, nrow(.), 6))
freq <- 6                 # Sentinel-1 revisit time (days)
firstdate <- as.Date("2016-01-01")
lastdate <- as.Date("2021-12-31")
all_dates <- seq(firstdate, lastdate, "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- indexmeans[[bandname]]
names(plotdata)[2] <- bandname
plotdata <- plotdata %>% pad(interval = "day")
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata %>% slice(seq(1, nrow(.), freq))
plotdata %>% view
firstdate <- as.Date("2016-01-02")
lastdate <- as.Date("2021-12-31")
all_dates <- seq(firstdate, lastdate, "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata %>% slice(seq(1, nrow(.), freq))
plotdata %>% View
plotdata %>% slice(seq(1, nrow(.), freq))
firstdate <- as.Date("2016-01-04")
lastdate <- as.Date("2021-12-31")
all_dates <- seq(firstdate, lastdate, "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata %>% slice(seq(1, nrow(.), freq))
lastdate <- as.Date("2021-12-27")
all_dates <- seq(firstdate, lastdate, "days") %>% data.frame()
names(all_dates)<-"date"
plotdata <- left_join(all_dates,plotdata,by="date")
plotdata %>% slice(seq(1, nrow(.), freq))
plotdata <- plotdata %>% slice(seq(1, nrow(.), freq))
plotdata$day <- as.double(difftime(ymd(plotdata$date), ymd("2016-01-01"), units="days"))+1
t <- as.vector(plotdata$day)  # Days since January 1, 2016
r <- t2rad(t,dpy)          # Transform days of year to radians
v <- as.vector(plotdata$RVI)   # RVI values
vx <- mean(vec.x(r,v), na.rm=TRUE) # Avg horizontal vector
vy <- mean(vec.y(r,v), na.rm=TRUE) # Avg vertical vector
rv_ang <- vec_ang(vx,vy)   # Angle of resultant vec (point of max activity)
av_ang <- avec_ang(rv_ang)  # Angle marking point of least activity
av_idx <- rad2idx(av_ang, spc=spc) # Index (1-spc) marking avg start of yr
ann_cum <- sum_cycle(v,av_idx,spc=spc)$cumsum # Accum. vals within each yr
365/6
spc <- 60 # floor(dpy/freq)            # Number of samples in one cycle (yr)
av_idx <- rad2idx(av_ang, spc=spc) # Index (1-spc) marking avg start of yr
ann_cum <- sum_cycle(v,av_idx,spc=spc)$cumsum # Accum. vals within each yr
dpy <- 364                 # Days/yr
dpy <- 364.2                 # Days/yr
r <- t2rad(t,dpy)          # Transform days of year to radians
vx <- mean(vec.x(r,v), na.rm=TRUE) # Avg horizontal vector
vy <- mean(vec.y(r,v), na.rm=TRUE) # Avg vertical vector
rv_ang <- vec_ang(vx,vy)   # Angle of resultant vec (point of max activity)
av_ang <- avec_ang(rv_ang)  # Angle marking point of least activity
av_idx <- rad2idx(av_ang, spc=spc) # Index (1-spc) marking avg start of yr
ann_cum <- sum_cycle(v,av_idx,spc=spc)$cumsum # Accum. vals within each yr
vx
vy
rv_ang
av_ang
data("mndvi")
lb <- 0.15
ub <- 0.8
s_p_yr
pmets
t <- as.vector(mndvi$day)
r <- t2rad(t,dpc=s_p_yr)
v <- as.vector()
v <- as.vector(mndvi$chl)
vx <- mean(vec.x(r,v), na.rm=TRUE) # Avg horizontal vector
vy <- mean(vec.y(r,v), na.rm=TRUE) # Avg vertical vector
rv_ang <- vec_ang(vx,vy)   # Angle of resultant vec (point of max activity)
av_ang <- avec_ang(rv_ang)  # Angle marking point of least activity
av_idx <- rad2idx(av_ang, spc=spc) # Index (1-spc) marking avg start of yr
av_day <- rad2d(avec_ang, dpc=dpy)
dpy
dpy <- 365
av_day <- rad2d(avec_ang, dpc=dpy)
av_day <- rad2d(av_ang, dpc=dpy)
av_ang <- avec_ang(rv_ang)
av_day <- rad2d(av_ang, dpc=dpy)
cumNDVI <- sum_cycle(v, av_idx, s_p_yr)$cumsum
c.CumNDVI
c
c <- 12
v
mndvi$chl
plotdata
getwd()
write.csv(plotdata, "RVI_sooretama_TS.csv")
