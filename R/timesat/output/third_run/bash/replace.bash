#combine means and measures of spreadmetric_type_names <- names(metrics_means_multiple)[-1] ; metric_spread_names <- names(metrics_spread_multiple)[-1] metrics_means <- metrics_means_multiple %>% pivot_longer(cols = all_of(metric_type_names),  names_to = "metric_type", values_to = "value") %>% mutate(mID=rep(seq(1,length(metric_type_names)), length(site.list)))metrics_spread <- metrics_spread_multiple %>% pivot_longer(cols = all_of(metric_spread_names),  names_to = "metric_type", values_to = "value") %>% mutate(mID=rep(seq(1,length(metric_type_names)), length(site.list)))#labels and reordering for nice plottinglabels <- c("Model 1: Optical Amplitude only", "Model 2: Phase Diff. (Peak)", "Model 2: Phase Diff. (Peak - radians)", "Model 3: Phase Diff. (Season Mid-Point)", "Model 3: Phase Diff. (Season Mid-Point - radians)", "Model 4: Phase Diff. (Ensemble)", "Model 4: Phase Diff. (Ensemble - radians)")seq <- seq(1,(length(site.list))*length(metric_type_names), by=length(site.list))IDs <- c() ; for (i in 1:length(site.list)) {IDs <- c(IDs, i+seq-1)}metrics_means <- metrics_means %>% mutate(orderID = IDs) %>% arrange(orderID)metrics_spread <- metrics_spread %>% mutate(orderID = IDs) %>% arrange(orderID)metrics_means <- metrics_means %>% mutate(value_spread = metrics_spread$value)#label factorsforesttype <- c("seasonal semi-deciduous forest", "broadleaf evergreen forest")metrics_means <- metrics_means %>% mutate(ftype=rep(foresttype,length(metric_type_names))) metrics_means$metric_type_1 <- factor(metrics_means$metric_type, levels=metrics_means$metric_type, labels = rep(labels,each=length(site.list)))metrics_means$metric_type_2 <- metrics_means$metric_type_1 %>% gsub(" - radians","",.)metrics_means$metric_type_2 <- factor(metrics_means$metric_type_2, levels=metrics_means$metric_type_2, labels = metrics_means$metric_type_2)metrics_means <- metrics_means %>% mutate(rownumber = c(paste0(S2_band, " Index"), paste0(S2_band, " Index"), "Phase Shift (Days)", "Phase Shift (Days)", "Phase Shift (Radians)", "Phase Shift (Radians)", "Phase Shift (Days)", "Phase Shift (Days)", "Phase Shift (Radians)", "Phase Shift (Radians)", "Phase Shift (Days)", "Phase Shift (Days)", "Phase Shift (Radians)", "Phase Shift (Radians)"))metrics_means <- metrics_means %>% mutate(value_spread1 = ifelse(grepl("_rad", metric_type), 1 - value_spread, value_spread)) # convert rho to deviationmetrics_means$study_site <- rep(c("PE Rio Doce", "REBIO Sooretama"), length=length(metrics_means$study_site)) metrics_means$study_site <- as.factor(metrics_means$study_site)metrics_means <- data.table(metrics_means)metrics_means[,y_min := value*0.75, by = metric_type_2]metrics_means[,y_max:=value*1.25, by = metric_type_2]